<!DOCTYPE html>
<html lang="en">
  <head>
    <div id="google_translate_element"></div>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="style.css" />
    <script
      src="https://kit.fontawesome.com/68dffed02e.js"
      crossorigin="anonymous"
    ></script>
    <link rel="icon" href="favicon.ico" />
    <title>Melody : Music for everyone</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    
  </head>

  <body>
   
  <!-- Google Translate Widget -->


  

 
    <main>
      <!-- Sidebar -->
      <aside>
        <div class="header">

          <div class="logo-title">
            <img src="favicon.ico" alt=""melody logo" class="logo"/>
          <h2>Melody</h2>
          </div>

          <p id="home-logo" class="active">
            <i class="fa-solid fa-house"></i> Home
          </p>
          <p id="searchbar">
            <i class="fa-solid fa-magnifying-glass"></i> Search
          </p>
        </div>

        <div class="playlist">
          <p onclick="window.location.href='library.html'" style="cursor:pointer;">
            <svg
              data-encore-id="icon"
              role="img"
              aria-hidden="true"
              viewBox="0 0 24 24"
              class="Svg-sc-ytk21e-0 bneLcE"
              width="20"
              height="20"
              style="vertical-align: middle; margin-right: 6px;"
            >
              <path
                d="M3 22a1 1 0 0 1-1-1V3a1 1 0 0 1 2 0v18a1 1 0 0 1-1 1zM15.5 2.134A1 1 0 0 0 14 3v18a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V6.464a1 1 0 0 0-.5-.866l-6-3.464zM9 2a1 1 0 0 0-1 1v18a1 1 0 1 0 2 0V3a1 1 0 0 0-1-1z"
              ></path>
            </svg>
            Your Library
          </p>
          <div class="lists">
            <ul id="libraryList"></ul>
          </div>
        </div>
      </aside>

      <script>
        // Load saved songs in the sidebar
        const libraryList = document.getElementById("libraryList");
        const library = JSON.parse(localStorage.getItem("library")) || [];

        if (library.length === 0) {
          libraryList.innerHTML = "<li style='color:gray;'>No saved songs</li>";
        } else {
          libraryList.innerHTML = library
            .map(
              (song) => `
                <li>
                  <div class="li-song" style="display:flex; align-items:center;">
                    <img src="images/music.svg" alt="Music Icon" />
                    <p style="margin-left:10px;">${song}</p>
                  </div>
                </li>`
            )
            .join("");
        }
      </script>

      <!-- Main Content (Dynamic) -->
      <div class="main-content" id="main-content">
        <!-- Home content will be dynamically loaded here -->
      </div>
    </main>

    <!-- Music Player -->
    <div class="player">
      <div class="current-song">
        <div>
          <img src="images/music.svg" alt="" />
          <p>Song Name</p>
          <svg
            data-encore-id="icon"
            role="img"
            aria-hidden="true"
            viewBox="0 0 16 16"
            class="Svg-sc-ytk21e-0 ceOVVX"
          >
            <path
              d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm11.748-1.97a.75.75 0 0 0-1.06-1.06l-4.47 4.47-1.405-1.406a.75.75 0 1 0-1.061 1.06l2.466 2.467 5.53-5.53z"
            ></path>
          </svg>
        </div>
      </div>
      <div class="panel">

      <div class="controls">
          <div class="tooltip-container">
            <img
              class="loop"
              id="loop"
              src="images/loop.svg"
              alt="Repeat"
              aria-label="Repeat"
            />
            <span class="tooltip-text">Repeat</span>
          </div>

          <div class="tooltip-container">
            <img
              class="previous"
              id="previous"
              src="images/previous.svg"
              alt="Previous"
              aria-label="Previous"
            />
            <span class="tooltip-text">Previous</span>
          </div>

          <div class="tooltip-container">
            <img
              id="play"
              src="images/play.svg"
              alt="Play/Pause"
              aria-label="Play/Pause"
            />
            <span class="tooltip-text">Play/Pause</span>
          </div>

          <div class="tooltip-container">
            <img
              class="next"
              id="next"
              src="images/next.svg"
              alt="Next"
              aria-label="Next"
            />
            <span class="tooltip-text">Next</span>
          </div>

          <div class="tooltip-container">
            <img
              class="shuffle"
              id="shuffle"
              src="images/shuffle.svg"
              alt="Shuffle"
              aria-label="Shuffle"
            />
            <span class="tooltip-text">Shuffle</span>
          </div>
      </div>

        <div class="progress-bar">
          <p class="current-duration">00:00</p>
          <input
            type="range"
            class="bar"
            id="seek-bar"
            value="0"
            min="0"
            max="100"
          />
          <p class="duration">00:00</p>
        </div>
      </div>
      <div class="volume">
        <div class="tooltip-container" >
          <img
            src="images/volume.svg"
            alt="Volume"
            role="button"
            tabindex="0"
            aria-label="Volume"
          />
          <span class="tooltip-text">Volume</span>
        </div>
        <input id="volume" type="range" max="100" min="0" value="100" />
      </div>
    </div>
    <div id="auth-backdrop" class="hidden"></div>

    <div class="auth-container hidden" id="auth-section">
      <button class="close-btn" id="close-auth">&times;</button>
      <div class="auth-toggle">
        <button id="show-login" class="active">Login</button>
        <button id="show-signup">Sign Up</button>
      </div>

      <form id="login-form" class="auth-form">
        <h2>Login</h2>
        <input type="email" placeholder="Email" required />
        <input type="password" placeholder="Password" required />
        <button type="submit">Log In</button>
      </form>

      <div id="status"></div>

      <script>
        // Load Home Page by default
        window.addEventListener("DOMContentLoaded", () => {
          const savedTheme = localStorage.getItem("theme");
          if (savedTheme === "bright") {
            document.body.classList.add("bright-mode");
          }

          // Load home page dynamically, then bind playlist cards
          loadPage("home.html").then(() => {
            bindPlaylistCards(); // ✅ Reattach playlist click events after content load
          });
        });

        // Dynamic Page Loader
        async function loadPage(page) {
          const res = await fetch(page);
          const content = await res.text();
          document.getElementById("main-content").innerHTML = content;

          // ✅ Reapply theme
          const savedTheme = localStorage.getItem("theme");
          if (savedTheme === "bright") {
            document.body.classList.add("bright-mode");
          } else {
            document.body.classList.remove("bright-mode");
          }

          // ✅ Rebind card click listeners after DOM updates
          setTimeout(() => {
            if (typeof bindPlaylistCards === "function") {
              bindPlaylistCards();
            }
          }, 50);

          // ✅ Re-attach theme toggle event listener if present
          const themeToggle = document.getElementById("theme-toggle");
          if (themeToggle) {
            updateThemeToggleText(themeToggle);
            themeToggle.addEventListener("click", function () {
              document.body.classList.toggle("bright-mode");
              localStorage.setItem(
                "theme",
                document.body.classList.contains("bright-mode")
                  ? "bright"
                  : "dark"
              );
              updateThemeToggleText(this);
            });
          }
        }

        // Update toggle text based on current theme
        function updateThemeToggleText(button) {
          if (document.body.classList.contains("bright-mode")) {
            button.textContent = "Light Mode";
          } else {
            button.textContent = "Dark Mode";
          }
        }

        // Sidebar Navigation
        const homeBtn = document.getElementById("home-logo");
        const searchBtn = document.getElementById("searchbar");

        homeBtn.addEventListener("click", () => {
          loadPage("home.html").then(() => {
            bindPlaylistCards(); // ✅ ensures playlist clicks work again
          });
          setActive(homeBtn);
        });

        searchBtn.addEventListener("click", () => {
          loadPage("search.html");
          setActive(searchBtn);
        });

        function setActive(activeBtn) {
          document
            .querySelectorAll("aside .header p")
            .forEach((btn) => btn.classList.remove("active"));
          activeBtn.classList.add("active");
        }
      </script>

      <script src="script.js"></script>
  </body>
</html>
